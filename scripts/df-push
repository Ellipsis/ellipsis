#!/bin/sh

basedir="$( cd -P "$( dirname "$0" )" && pwd )"/..

cd $basedir
if [ -d ".hg" ]; then
    hg ci
    hg push
else
    git commit -a
    git push
fi

for repo in `find . -depth 2 -name '.hg' -o -depth 2 -name '.git' | cut -d / -f 2`; do
    cd $basedir/$repo
    if [ -d ".hg" ]; then
        hg ci
        hg push
    else
        git commit -a
        git push
    fi
done
